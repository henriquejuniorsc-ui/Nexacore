generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider  = "postgresql"
  url       = env("DATABASE_URL")
  directUrl = env("DIRECT_URL")
}

model Tenant {
  id                String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt         DateTime           @default(now()) @db.Timestamptz(6)
  updatedAt         DateTime           @default(now()) @updatedAt @db.Timestamptz(6)
  name              String
  slug              String             @unique
  email             String
  phone             String?
  document          String?
  logo              String?
  description       String?
  address           String?
  city              String?
  state             String?
  zipCode           String?
  businessHours     Json?
  timezone          String             @default("America/Sao_Paulo")
  systemPrompt      String?
  aiEnabled         Boolean            @default(true)
  chatwootUrl       String?
  chatwootApiKey    String?
  chatwootAccountId String?
  chatwootInboxId   String?
  googleCalendarIds Json?              @default("[]")
  googleCredentials Json?
  reminderSettings  Json?
  isActive          Boolean            @default(true)
  onboardingStep    Int                @default(0)
  aiConversations   AIConversation[]
  appointments      Appointment[]
  cannedResponses   CannedResponse[]
  clients           Client[]
  conversations     Conversation[]
  invitations       Invitation[]
  messages          Message[]
  payments          Payment[]
  procedureTypes    ProcedureType[]
  products          Product[]
  professionals     Professional[]
  services          Service[]
  stockMovements    StockMovement[]
  subscription      Subscription?
  tags              Tag[]
  upsellRules       UpsellRule[]
  upsellSuggestions UpsellSuggestion[]
  users             User[]

  @@index([email], map: "idx_tenant_email")
  @@index([slug], map: "idx_tenant_slug")
}

model Subscription {
  id                  String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt           DateTime           @default(now()) @db.Timestamptz(6)
  updatedAt           DateTime           @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId            String             @unique
  plan                SubscriptionPlan   @default(STARTER)
  status              SubscriptionStatus @default(TRIALING)
  maxProfessionals    Int                @default(1)
  maxAppointments     Int                @default(100)
  priceMonthly        Float              @default(97)
  billingCycle        BillingCycle       @default(MONTHLY)
  asaasCustomerId     String?
  asaasSubscriptionId String?
  trialEndsAt         DateTime?          @db.Timestamptz(6)
  currentPeriodStart  DateTime?          @db.Timestamptz(6)
  currentPeriodEnd    DateTime?          @db.Timestamptz(6)
  canceledAt          DateTime?          @db.Timestamptz(6)
  tenant              Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([status], map: "idx_subscription_status")
  @@index([tenantId], map: "idx_subscription_tenant_id")
}

model Invitation {
  id             String           @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime         @default(now()) @db.Timestamptz(6)
  expiresAt      DateTime         @db.Timestamptz(6)
  tenantId       String
  email          String
  name           String
  role           UserRole         @default(PROFESSIONAL)
  professionalId String?
  token          String           @unique
  status         InvitationStatus @default(PENDING)
  acceptedAt     DateTime?        @db.Timestamptz(6)
  invitedBy      String?
  professional   Professional?    @relation(fields: [professionalId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant         Tenant           @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenantId, email])
  @@index([tenantId, status], map: "idx_invitation_tenant_status")
  @@index([token], map: "idx_invitation_token")
}

model User {
  id                    String           @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt             DateTime         @default(now()) @db.Timestamptz(6)
  updatedAt             DateTime         @default(now()) @updatedAt @db.Timestamptz(6)
  clerkUserId           String           @unique
  email                 String
  name                  String
  avatar                String?
  phone                 String?
  tenantId              String
  role                  UserRole         @default(PROFESSIONAL)
  professionalId        String?          @unique
  isActive              Boolean          @default(true)
  lastLoginAt           DateTime?        @db.Timestamptz(6)
  preferences           Json?
  aiConversations       AIConversation[]
  assignedConversations Conversation[]
  professional          Professional?    @relation(fields: [professionalId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant                Tenant           @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([clerkUserId], map: "idx_user_clerk_user_id")
  @@index([email], map: "idx_user_email")
  @@index([tenantId], map: "idx_user_tenant_id")
}

model Professional {
  id                  String                @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt           DateTime              @default(now()) @db.Timestamptz(6)
  updatedAt           DateTime              @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId            String
  name                String
  email               String?
  phone               String?
  avatar              String?
  specialty           String?
  bio                 String?
  googleCalendarId    String?
  googleCredentials   Json?
  syncGoogleCalendar  Boolean               @default(false)
  workingHours        Json?
  appointmentDuration Int                   @default(60)
  bufferTime          Int                   @default(15)
  isActive            Boolean               @default(true)
  appointments        Appointment[]
  invitations         Invitation[]
  products            Product[]
  tenant              Tenant                @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  services            ProfessionalService[]
  user                User?

  @@index([tenantId], map: "idx_professional_tenant_id")
}

model Service {
  id               String                @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt        DateTime              @default(now()) @db.Timestamptz(6)
  updatedAt        DateTime              @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId         String
  name             String
  description      String?
  duration         Int
  price            Float
  procedureTypeId  String?
  category         String?
  upsellServiceIds Json?                 @default("[]")
  isActive         Boolean               @default(true)
  appointments     Appointment[]
  professionals    ProfessionalService[]
  procedureType    ProcedureType?        @relation(fields: [procedureTypeId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant           Tenant                @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  suggestUpsells   UpsellRule[]          @relation("SuggestService")
  triggerUpsells   UpsellRule[]          @relation("TriggerService")

  @@index([tenantId], map: "idx_service_tenant_id")
}

model ProfessionalService {
  id             String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  professionalId String
  serviceId      String
  customPrice    Float?
  customDuration Int?
  professional   Professional @relation(fields: [professionalId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  service        Service      @relation(fields: [serviceId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([professionalId, serviceId])
}

model ProcedureType {
  id               String            @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt        DateTime          @default(now()) @db.Timestamptz(6)
  updatedAt        DateTime          @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId         String
  name             String
  description      String?
  reminderEnabled  Boolean           @default(true)
  reminderDays     Int               @default(120)
  reminderMessage  String?
  procedureRecords ProcedureRecord[]
  tenant           Tenant            @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  services         Service[]

  @@unique([tenantId, name])
  @@index([tenantId], map: "idx_procedure_type_tenant_id")
}

model Product {
  id             String          @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime        @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime        @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId       String
  professionalId String?
  name           String
  description    String?
  sku            String?
  barcode        String?
  costPrice      Float           @default(0)
  salePrice      Float           @default(0)
  quantity       Int             @default(0)
  minQuantity    Int             @default(5)
  unit           String          @default("un")
  category       String?
  brand          String?
  isActive       Boolean         @default(true)
  professional   Professional?   @relation(fields: [professionalId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant         Tenant          @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  stockMovements StockMovement[]

  @@unique([tenantId, sku])
  @@index([professionalId], map: "idx_product_professional_id")
  @@index([tenantId], map: "idx_product_tenant_id")
}

model StockMovement {
  id            String            @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt     DateTime          @default(now()) @db.Timestamptz(6)
  tenantId      String
  productId     String
  type          StockMovementType
  quantity      Int
  reason        String?
  appointmentId String?
  userId        String?
  unitCost      Float?
  totalCost     Float?
  product       Product           @relation(fields: [productId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant        Tenant            @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([productId], map: "idx_stock_movement_product_id")
  @@index([tenantId], map: "idx_stock_movement_tenant_id")
}

model Client {
  id                      String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt               DateTime           @default(now()) @db.Timestamptz(6)
  updatedAt               DateTime           @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId                String
  name                    String
  email                   String?
  phone                   String
  cpf                     String?
  birthDate               DateTime?          @db.Timestamptz(6)
  address                 String?
  city                    String?
  state                   String?
  zipCode                 String?
  chatwootContactId       String?
  asaasCustomerId         String?
  prefersAudio            Boolean            @default(false)
  allowsMarketing         Boolean            @default(true)
  notes                   String?
  preferredProfessionalId String?
  isActive                Boolean            @default(true)
  appointments            Appointment[]
  tenant                  Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  conversations           Conversation[]
  messages                Message[]
  payments                Payment[]
  procedureRecords        ProcedureRecord[]
  upsellSuggestions       UpsellSuggestion[]

  @@unique([tenantId, phone])
  @@index([phone], map: "idx_client_phone")
  @@index([tenantId], map: "idx_client_tenant_id")
}

model ProcedureRecord {
  id                   String        @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt            DateTime      @default(now()) @db.Timestamptz(6)
  clientId             String
  procedureTypeId      String
  appointmentId        String?
  performedAt          DateTime      @default(now()) @db.Timestamptz(6)
  notes                String?
  reminderSentAt       DateTime?     @db.Timestamptz(6)
  reminderScheduledFor DateTime?     @db.Timestamptz(6)
  nextReminderAt       DateTime?     @db.Timestamptz(6)
  appointment          Appointment?  @relation(fields: [appointmentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  client               Client        @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  procedureType        ProcedureType @relation(fields: [procedureTypeId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([clientId], map: "idx_procedure_record_client_id")
  @@index([nextReminderAt], map: "idx_procedure_record_next_reminder_at")
}

model Appointment {
  id                String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt         DateTime           @default(now()) @db.Timestamptz(6)
  updatedAt         DateTime           @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId          String
  clientId          String
  professionalId    String
  serviceId         String
  startTime         DateTime           @db.Timestamptz(6)
  endTime           DateTime           @db.Timestamptz(6)
  duration          Int
  googleEventId     String?
  googleMeetLink    String?
  status            AppointmentStatus  @default(SCHEDULED)
  notes             String?
  internalNotes     String?
  reminder24hSent   Boolean            @default(false)
  reminder24hSentAt DateTime?          @db.Timestamptz(6)
  reminder2hSent    Boolean            @default(false)
  reminder2hSentAt  DateTime?          @db.Timestamptz(6)
  clientConfirmed   Boolean?
  clientConfirmedAt DateTime?          @db.Timestamptz(6)
  price             Float?
  source            AppointmentSource  @default(MANUAL)
  client            Client             @relation(fields: [clientId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  professional      Professional       @relation(fields: [professionalId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  service           Service            @relation(fields: [serviceId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant            Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  payment           Payment?
  procedureRecords  ProcedureRecord[]
  resultUpsell      UpsellSuggestion?  @relation("ResultAppointment")
  triggerUpsells    UpsellSuggestion[] @relation("TriggerAppointment")

  @@index([clientId], map: "idx_appointment_client_id")
  @@index([professionalId], map: "idx_appointment_professional_id")
  @@index([startTime], map: "idx_appointment_start_time")
  @@index([status], map: "idx_appointment_status")
  @@index([tenantId], map: "idx_appointment_tenant_id")
}

model Payment {
  id             String        @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime      @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime      @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId       String
  clientId       String
  appointmentId  String?       @unique
  amount         Float
  description    String?
  asaasPaymentId String?
  billingType    BillingType   @default(PIX)
  dueDate        DateTime      @db.Timestamptz(6)
  paidAt         DateTime?     @db.Timestamptz(6)
  invoiceUrl     String?
  pixCode        String?
  pixQrCode      String?
  status         PaymentStatus @default(PENDING)
  appointment    Appointment?  @relation(fields: [appointmentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  client         Client        @relation(fields: [clientId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant         Tenant        @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([clientId], map: "idx_payment_client_id")
  @@index([status], map: "idx_payment_status")
  @@index([tenantId], map: "idx_payment_tenant_id")
}

model Message {
  id                     String        @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt              DateTime      @default(now()) @db.Timestamptz(6)
  tenantId               String
  clientId               String
  conversationId         String?
  content                String
  role                   MessageRole
  chatwootMessageId      String?
  chatwootConversationId String?
  metadata               Json?
  client                 Client        @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  conversation           Conversation? @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant                 Tenant        @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([clientId], map: "idx_message_client_id")
  @@index([conversationId], map: "idx_message_conversation_id")
  @@index([createdAt], map: "idx_message_created_at")
  @@index([tenantId], map: "idx_message_tenant_id")
}

model AIConversation {
  id        String      @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt DateTime    @default(now()) @db.Timestamptz(6)
  updatedAt DateTime    @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId  String
  userId    String
  title     String?
  isActive  Boolean     @default(true)
  tenant    Tenant      @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  user      User        @relation(fields: [userId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  messages  AIMessage[]

  @@index([tenantId], map: "idx_ai_conversation_tenant_id")
  @@index([userId], map: "idx_ai_conversation_user_id")
}

model AIMessage {
  id             String         @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime       @default(now()) @db.Timestamptz(6)
  conversationId String
  role           AIMessageRole
  content        String
  metadata       Json?
  conversation   AIConversation @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([conversationId], map: "idx_ai_message_conversation_id")
}

model Conversation {
  id                 String                 @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt          DateTime               @default(now()) @db.Timestamptz(6)
  updatedAt          DateTime               @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId           String
  clientId           String
  status             ConversationStatus     @default(OPEN)
  channel            ConversationChannel    @default(WHATSAPP)
  assignedToId       String?
  professionalId     String?
  aiEnabled          Boolean                @default(true)
  aiSchedulingState  Json?
  messageCount       Int                    @default(0)
  unreadCount        Int                    @default(0)
  lastMessageAt      DateTime?              @db.Timestamptz(6)
  lastMessagePreview String?
  avgResponseTime    Int?
  score              Int                    @default(0)
  temperature        LeadTemperature        @default(COLD)
  sentiment          Float?
  purchaseIntent     PurchaseIntent         @default(NONE)
  assignedTo         User?                  @relation(fields: [assignedToId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  client             Client                 @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant             Tenant                 @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  activities         ConversationActivity[]
  notes              ConversationNote[]
  tags               ConversationTag[]
  messages           Message[]

  @@unique([tenantId, clientId])
  @@index([assignedToId], map: "idx_conversation_assigned_to")
  @@index([professionalId], map: "idx_conversation_professional")
  @@index([tenantId, lastMessageAt], map: "idx_conversation_tenant_last_message")
  @@index([tenantId, status], map: "idx_conversation_tenant_status")
  @@index([tenantId, temperature], map: "idx_conversation_tenant_temperature")
}

model Tag {
  id            String            @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt     DateTime          @default(now()) @db.Timestamptz(6)
  tenantId      String
  name          String
  color         String            @default("#3B82F6")
  icon          String?
  category      String?
  conversations ConversationTag[]
  tenant        Tenant            @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenantId, name])
  @@index([tenantId], map: "idx_tag_tenant_id")
}

model ConversationTag {
  id             String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime     @default(now()) @db.Timestamptz(6)
  conversationId String
  tagId          String
  assignedById   String?
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tag            Tag          @relation(fields: [tagId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([conversationId, tagId])
  @@index([tagId], map: "idx_conversation_tag_tag_id")
}

model ConversationActivity {
  id             String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime     @default(now()) @db.Timestamptz(6)
  conversationId String
  type           ActivityType
  title          String
  description    String?
  metadata       Json?
  performedById  String?
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([conversationId, createdAt], map: "idx_conv_activity_conversation_created")
}

model ConversationNote {
  id             String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt      DateTime     @default(now()) @db.Timestamptz(6)
  updatedAt      DateTime     @default(now()) @updatedAt @db.Timestamptz(6)
  conversationId String
  content        String
  authorId       String?
  isPinned       Boolean      @default(false)
  conversation   Conversation @relation(fields: [conversationId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([conversationId, createdAt], map: "idx_conv_note_conversation_created")
}

model CannedResponse {
  id        String   @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt DateTime @default(now()) @db.Timestamptz(6)
  updatedAt DateTime @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId  String
  title     String
  content   String
  shortcut  String?
  category  String?
  tenant    Tenant   @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenantId, shortcut])
  @@index([tenantId], map: "idx_canned_response_tenant_id")
}

model UpsellRule {
  id                      String             @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt               DateTime           @default(now()) @db.Timestamptz(6)
  updatedAt               DateTime           @default(now()) @updatedAt @db.Timestamptz(6)
  tenantId                String
  name                    String
  description             String?
  triggerServiceId        String
  suggestServiceId        String
  discountPercent         Float?             @default(0)
  discountFixed           Float?             @default(0)
  priority                Int                @default(0)
  isActive                Boolean            @default(true)
  suggestTiming           UpsellTiming       @default(AFTER_BOOKING)
  minDaysSinceLastService Int?
  maxTimesOffered         Int?               @default(3)
  customMessage           String?
  suggestService          Service            @relation("SuggestService", fields: [suggestServiceId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant                  Tenant             @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  triggerService          Service            @relation("TriggerService", fields: [triggerServiceId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  suggestions             UpsellSuggestion[]

  @@unique([tenantId, triggerServiceId, suggestServiceId])
  @@index([tenantId, isActive], map: "idx_upsell_rule_tenant_active")
  @@index([triggerServiceId], map: "idx_upsell_rule_trigger_service")
}

model UpsellSuggestion {
  id                   String       @id @default(dbgenerated("(gen_random_uuid())::text"))
  createdAt            DateTime     @default(now()) @db.Timestamptz(6)
  tenantId             String
  ruleId               String
  clientId             String
  triggerAppointmentId String?
  status               UpsellStatus @default(SUGGESTED)
  resultAppointmentId  String?      @unique
  originalPrice        Float?
  discountAmount       Float?
  finalPrice           Float?
  suggestedAt          DateTime     @default(now()) @db.Timestamptz(6)
  viewedAt             DateTime?    @db.Timestamptz(6)
  respondedAt          DateTime?    @db.Timestamptz(6)
  convertedAt          DateTime?    @db.Timestamptz(6)
  rejectedAt           DateTime?    @db.Timestamptz(6)
  channel              String?      @default("WHATSAPP")
  clientResponse       String?
  client               Client       @relation(fields: [clientId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  resultAppointment    Appointment? @relation("ResultAppointment", fields: [resultAppointmentId], references: [id], onDelete: NoAction, onUpdate: NoAction)
  rule                 UpsellRule   @relation(fields: [ruleId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tenant               Tenant       @relation(fields: [tenantId], references: [id], onDelete: Cascade, onUpdate: NoAction)
  triggerAppointment   Appointment? @relation("TriggerAppointment", fields: [triggerAppointmentId], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([clientId], map: "idx_upsell_suggestion_client_id")
  @@index([createdAt], map: "idx_upsell_suggestion_created_at")
  @@index([ruleId], map: "idx_upsell_suggestion_rule_id")
  @@index([tenantId, status], map: "idx_upsell_suggestion_tenant_status")
}

enum SubscriptionPlan {
  STARTER
  PRO
  BUSINESS
}

enum SubscriptionStatus {
  TRIALING
  ACTIVE
  PAST_DUE
  CANCELED
  PAUSED
}

enum BillingCycle {
  MONTHLY
  YEARLY
}

enum InvitationStatus {
  PENDING
  ACCEPTED
  EXPIRED
  CANCELED
}

enum UserRole {
  OWNER
  ADMIN
  PROFESSIONAL
  RECEPTIONIST
}

enum StockMovementType {
  IN
  OUT
  SALE
  LOSS
  ADJUST
  RETURN
}

enum AppointmentStatus {
  SCHEDULED
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELED
  NO_SHOW
}

enum AppointmentSource {
  MANUAL
  AI
  ONLINE
  WHATSAPP
}

enum BillingType {
  PIX
  BOLETO
  CREDIT_CARD
}

enum PaymentStatus {
  PENDING
  CONFIRMED
  RECEIVED
  OVERDUE
  REFUNDED
  CANCELED
}

enum MessageRole {
  HUMAN
  ASSISTANT
  SYSTEM
}

enum AIMessageRole {
  USER
  ASSISTANT
  SYSTEM
  TOOL
}

enum ConversationStatus {
  OPEN
  PENDING
  RESOLVED
  CLOSED
}

enum ConversationChannel {
  WHATSAPP
  EMAIL
  SMS
  WEBCHAT
}

enum LeadTemperature {
  COLD
  WARM
  HOT
}

enum PurchaseIntent {
  NONE
  LOW
  MEDIUM
  HIGH
}

enum ActivityType {
  CONVERSATION_STARTED
  MESSAGE_RECEIVED
  MESSAGE_SENT
  TAG_ADDED
  TAG_REMOVED
  STATUS_CHANGED
  ASSIGNED
  UNASSIGNED
  AI_ENABLED
  AI_DISABLED
  SCORE_UPDATED
  NOTE_ADDED
  APPOINTMENT_CREATED
  APPOINTMENT_CONFIRMED
  REMINDER_SENT
  CLIENT_MERGED
}

enum UpsellTiming {
  DURING_CHAT
  AFTER_BOOKING
  AFTER_SERVICE
  REMINDER
}

enum UpsellStatus {
  SUGGESTED
  VIEWED
  ACCEPTED
  REJECTED
  CONVERTED
  EXPIRED
}

enum activity_type {
  CONVERSATION_STARTED
  MESSAGE_RECEIVED
  MESSAGE_SENT
  TAG_ADDED
  TAG_REMOVED
  STATUS_CHANGED
  ASSIGNED
  UNASSIGNED
  AI_ENABLED
  AI_DISABLED
  SCORE_UPDATED
  NOTE_ADDED
  APPOINTMENT_CREATED
  APPOINTMENT_CONFIRMED
  REMINDER_SENT
  CLIENT_MERGED
}

enum ai_message_role {
  USER
  ASSISTANT
  SYSTEM
  TOOL
}

enum appointment_source {
  MANUAL
  AI
  ONLINE
  WHATSAPP
}

enum appointment_status {
  SCHEDULED
  CONFIRMED
  IN_PROGRESS
  COMPLETED
  CANCELED
  NO_SHOW
}

enum billing_cycle {
  MONTHLY
  YEARLY
}

enum billing_type {
  PIX
  BOLETO
  CREDIT_CARD
}

enum conversation_channel {
  WHATSAPP
  EMAIL
  SMS
  WEBCHAT
}

enum conversation_status {
  OPEN
  PENDING
  RESOLVED
  CLOSED
}

enum invitation_status {
  PENDING
  ACCEPTED
  EXPIRED
  CANCELED
}

enum lead_temperature {
  COLD
  WARM
  HOT
}

enum message_role {
  HUMAN
  ASSISTANT
  SYSTEM
}

enum payment_status {
  PENDING
  CONFIRMED
  RECEIVED
  OVERDUE
  REFUNDED
  CANCELED
}

enum purchase_intent {
  NONE
  LOW
  MEDIUM
  HIGH
}

enum stock_movement_type {
  IN
  OUT
  SALE
  LOSS
  ADJUST
  RETURN
}

enum subscription_plan {
  STARTER
  PRO
  BUSINESS
}

enum subscription_status {
  TRIALING
  ACTIVE
  PAST_DUE
  CANCELED
  PAUSED
}

enum upsell_status {
  SUGGESTED
  VIEWED
  ACCEPTED
  REJECTED
  CONVERTED
  EXPIRED
}

enum upsell_timing {
  DURING_CHAT
  AFTER_BOOKING
  AFTER_SERVICE
  REMINDER
}

enum user_role {
  OWNER
  ADMIN
  PROFESSIONAL
  RECEPTIONIST
}
